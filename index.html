<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fluent Design Code Editor</title>
  <style>
    :root {
      --brand: #2563eb;
      --bg: #f3f4f6;
      --card: rgba(255,255,255,0.65); /* Ø´ÙØ§ÙÙŠØ© */
      --text: #111827;
      --border: rgba(255,255,255,0.3);
      --radius: 14px;
      --shadow: 0 8px 32px rgba(0,0,0,0.12);
      --transition: all 0.35s ease;
      --blur: 12px;
    }
    body[data-theme="dark"] {
      --bg: #0f172a;
      --card: rgba(17,24,39,0.55);
      --text: #e5e7eb;
      --border: rgba(255,255,255,0.15);
      --brand: #60a5fa;
      --shadow: 0 10px 36px rgba(0,0,0,0.35);
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      height: 100vh;
      transition: var(--transition);
    }
    header {
      background: var(--card);
      backdrop-filter: blur(var(--blur)) saturate(180%);
      color: var(--text);
      padding: 14px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 10;
      border-bottom: 1px solid var(--border);
    }
    .controls {
      display: flex;
      gap: 10px;
    }
    select, button {
      border: none;
      border-radius: var(--radius);
      padding: 8px 12px;
      font-size: 14px;
      font-family: 'Segoe UI';
      cursor: pointer;
      transition: var(--transition);
      background: var(--card);
      color: var(--text);
      backdrop-filter: blur(var(--blur));
    }
    button {
      font-weight: 600;
    }
    button:hover {
      background: var(--brand);
      color: #fff;
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }
    main {
      display: flex;
      flex: 1;
      gap: 16px;
      padding: 16px;
      opacity: 1;
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    body.fade main {
      opacity: 0;
      transform: translateY(10px);
    }
    #editor, #preview {
      flex: 1;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      transition: var(--transition);
      background: var(--card);
      backdrop-filter: blur(var(--blur)) saturate(180%);
      border: 1px solid var(--border);
    }
    #editor {
      font-size: 26px; /* Ø®Ø· Ø§ÙØªØ±Ø§Ø¶ÙŠ ÙƒØ¨ÙŠØ± */
    }
    #preview {
      border: none;
    }
    #editor:hover, #preview:hover {
      transform: scale(1.01);
    }
  </style>
</head>
<body data-theme="light">
  <header>
    <span>Fluent Design Code Editor</span>
    <div class="controls">
      <select id="language">
        <option value="html">HTML</option>
        <option value="css">CSS</option>
        <option value="javascript">JavaScript</option>
        <option value="java">Java</option>
        <option value="python">Python</option>
        <option value="csharp">C#</option>
        <option value="cpp">C++</option>
      </select>
      <select id="fontSize">
        <option value="18">18px</option>
        <option value="24">24px</option>
        <option value="26" selected>26px</option>
        <option value="32">32px</option>
      </select>
      <button id="run">ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
      <button id="toggleTheme">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹</button>
      <button id="download">ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯</button>
    </div>
  </header>
  <main>
    <div id="editor"><h1>Ù…Ø±Ø­Ø¨Ø§ ÙŠØ§ ÙŠØ§Ø³Ø± ğŸ‘‹</h1></div>
    <iframe id="preview"></iframe>
  </main>

  <!-- ØªØ­Ù…ÙŠÙ„ Ace Editor -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.3/ace.js"></script>
  <script>
    const editor = ace.edit("editor");
    editor.setTheme("ace/theme/chrome"); // Ø«ÙŠÙ… ÙØ§ØªØ­ Ø§ÙØªØ±Ø§Ø¶ÙŠ
    editor.session.setMode("ace/mode/html");
    editor.setOptions({
      fontSize: "26px",
      showPrintMargin: false,
      showGutter: true,
      highlightActiveLine: true
    });

    const preview = document.getElementById("preview");
    const runBtn = document.getElementById("run");
    const langSel = document.getElementById("language");
    const toggleBtn = document.getElementById("toggleTheme");
    const fontSel = document.getElementById("fontSize");
    const downloadBtn = document.getElementById("download");
    const body = document.body;

    // ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©
    langSel.addEventListener("change", () => {
      const lang = langSel.value;
      editor.session.setMode("ace/mode/" + lang);
    });

    // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„Ù„ØºØ§Øª Ø§Ù„ÙˆÙŠØ¨ ÙÙ‚Ø·
    runBtn.addEventListener("click", () => {
      const lang = langSel.value;
      const code = editor.getValue();
      if(lang === "html"){
        preview.srcdoc = code;
      } else if(lang === "css"){
        preview.srcdoc = `<style>${code}</style><div style="padding:20px"><h2>Ù…Ø¹Ø§ÙŠÙ†Ø© CSS</h2></div>`;
      } else if(lang === "javascript"){
        preview.srcdoc = `<script>${code}<\/script><div style="padding:20px"><h2>Ù…Ø¹Ø§ÙŠÙ†Ø© JavaScript</h2></div>`;
      } else {
        preview.srcdoc = `<div style="padding:20px;font-family:Segoe UI"><h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù„ØºØ© (${lang})</h3><p>Ø§Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ ÙˆØ´ØºÙ‘Ù„Ù‡ ÙÙŠ Ø¨ÙŠØ¦ØªÙ‡ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©.</p></div>`;
      }
    });

    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ (Light/Dark) Ù…Ø¹ Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Fade/Slide
    toggleBtn.addEventListener("click", () => {
      body.classList.add("fade");
      setTimeout(() => {
        const isDark = body.getAttribute("data-theme") === "dark";
        body.setAttribute("data-theme", isDark ? "light" : "dark");
        editor.setTheme(isDark ? "ace/theme/chrome" : "ace/theme/monokai");
        body.classList.remove("fade");
      }, 400);
    });

    // ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø®Ø· Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§
    fontSel.addEventListener("change", () => {
      const size = fontSel.value + "px";
      editor.setOptions({ fontSize: size });
    });

    // ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ ÙƒÙ…Ù„Ù
    downloadBtn.addEventListener("click", () => {
      const lang = langSel.value;
      const code = editor.getValue();
      const extMap = {
        html:'html', css:'css', javascript:'js', java:'java', python:'py',
        csharp:'cs', cpp:'cpp'
      };
      const ext = extMap[lang] || 'txt';
      const blob = new Blob([code], {type:'text/plain;charset=utf-8'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `code.${ext}`;
      a.click();
      URL.revokeObjectURL(a.href);
    });

    // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø£ÙˆÙ„ÙŠØ©
    preview.srcdoc = editor.getValue();
  </script>
</body>
</html>
